
import xml
import yang.data
from y_testy import *

def service1():
    root = y_testy()
    root.c1.l1 = "a leaf written by service1"
    root.c1.c2.l3 = "also set by service1"

    e1 = root.c1.list1.create("bajs")
    e1.l5 = "set by service1"

    return root.to_gdata()

def service2():
    mod = y_testy()
    mod.c1.l2 = "set by service2"
    mod.c1.c2.l4 = "set by service2"

    e1 = mod.c1.list1.create("shit")
    e1.l5 = "set by service2"

    return mod.to_gdata()

#def service3():
#    mod = y_testy.y_testy(
#        c1 = y_testy.y_testy_c1(
#            l2 = "set by service3",
#            c2 = y_testy.y_testy_c1_c2(
#                l4 = "set by service3"
#            )
#        ),
#        list1 = [
#            y_testy.y_testy_list1_element(....)
#        ]
#
#    )
#    return mod.to_gdata()

def foo():
    root = y_testy()
    root.c1.l1 = "a leaf written by service1"
    root.c1.c2.l3 = "also set by service1"
    e_foo = root.c1.list1.create("foo")
    e_foo.l5 = "hiaho"

    print(root.to_gdata().to_xmlstr())

    gd = root.to_gdata()
    print(gd)
    a = y_testy.from_gdata(gd)
    print(a.c1.l1)
    print(a.c1.c2.l3)

    x = a.to_gdata().to_xmlstr()
    print("XML str output:")
    print(x)
    xml_node = xml.decode(x)
    print("decoded XML:")
    print(xml_node)
    xin = y_testy.from_xml(xml_node)
    print("another roundtrip:")
    print(xin.to_gdata().to_xmlstr())



actor main(env):
    foo()
#    data1 = service1()
#    data2 = service2()
#    merged_config = yang.data.merge(data1, data2)
#    y_testy.
#    print(merged_config.to_xmlstr())
    env.exit(0)
